{"remainingRequest":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\src\\views\\Order.vue?vue&type=style&index=0&id=3c1ef684&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\src\\views\\Order.vue","mtime":1617708212000},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\css-loader\\dist\\cjs.js","mtime":1695374999050},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1695374999645},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\postcss-loader\\src\\index.js","mtime":1695374999532},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\less-loader\\dist\\cjs.js","mtime":1695375012442},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1695374980619},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\vue-loader\\lib\\index.js","mtime":1695374999645}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5iYWN7CiAgYmFja2dyb3VuZC1jb2xvcjojZjhmOGY4OwogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAvL2hlaWdodDogMTAwJTsKICBwYWRkaW5nLWJvdHRvbTogNDB2aDsgCn0KLnZhbi1wdWxsLXJlZnJlc2h7CiAgaGVpZ2h0OiAxMDAlOwogIHBhZGRpbmc6IDQ1cHggMDsKfQoudmFuLW5hdi1iYXJ7CiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAxNzAsIDIzOCwgMSk7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgd2lkdGg6IDEwMCU7CiAgei1pbmRleDogOTk7Cn0KL2RlZXAvLnZhbi1uYXYtYmFyX190aXRsZXsKICBjb2xvcjogd2hpdGU7Cn0KL2RlZXAvLnZhbi10YWJ7CiAgYmFja2dyb3VuZC1jb2xvcjojZjhmOGY4Owp9Ci9kZWVwLy5lbC1jYXJkX19ib2R5ewogIHBhZGRpbmc6OHB4Owp9Ci52YW4tcHVsbC1yZWZyZXNoewogIGhlaWdodDogMTAwJTsKfQouYm94LWNhcmR7CiAgYmFja2dyb3VuZDogI2ZiZmJmYjsKICBib3JkZXItcmFkaXVzOiAxMHB4OwogIG1hcmdpbjogMTVweDsKfQoudHJhaW5pY29uewogIGJhY2tncm91bmQtY29sb3I6IHJlZDsKICBoZWlnaHQ6IDIwcHg7CiAgd2lkdGg6NjVweDsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgYmFja2dyb3VuZDogdXJsKCcuLi9hc3NldHMvb3JkZXIvYXJyaXZlMS5wbmcnKSBuby1yZXBlYXQ7Cn0KLmNpdHl7CiAgZm9udC1zaXplOiAyMHB4OwogIGZvbnQtd2VpZ2h0OiBib2xkOwp9Ci5vdGhlcmluZm97CiAgZm9udC1zaXplOiAxNHB4OwogIG1hcmdpbi10b3A6IDVweDsKfQoucHJpY2V7CiAgZm9udC1zaXplOiAxN3B4Owp9Ci5kZWxidXR0b257CiAgbWFyZ2luLXRvcDogMTBweDsKfQo="},{"version":3,"sources":["Order.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Order.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"bac\" v-if=\"showflag\">\n     <van-nav-bar title=\"我的订单\"></van-nav-bar>    \n      <!-- 刷新组件 -->\n      <van-pull-refresh v-model=\"isLoading\" @refresh=\"onRefresh\">\n\n      <van-tabs v-model=\"active\" animated @change=\"changeactive\">\n      <van-tab v-for=\"(itemz,indexz) in tabs\" :key=\"indexz\" :title=\"itemz\">\n\n         <div v-if=\"ordernum[indexz]===0\"> <van-empty description=\"来到了没有出行的荒野\" /></div>\n         <div  class=\"text item\" v-for=\"(item,index) in orderlist\" :key=\"index\" @click=\"detail(item.id)\">\n\n          <el-card class=\"box-card\" v-if=\"indexz==0||indexz==item.status||(indexz==2&&item.status==5)\">\n              <van-row><van-col span=\"4\" class=\"otherinfo\">{{item.trainname}}</van-col></van-row>\n              <van-row>\n                <van-col span=\"8\" class=\"city\">{{item.startcity}}</van-col>\n                <van-col span=\"8\"><i class=\"trainicon\" /></van-col>\n                <van-col span=\"8\" class=\"city\">{{item.endcity}}</van-col>\n              </van-row>\n              <van-row class=\"otherinfo\">\n                <van-col span=\"8\">{{item.starttime}}</van-col>\n                <van-col span=\"8\">{{item.traindate}}</van-col>\n                <van-col span=\"8\">{{item.endtime}}</van-col>\n              </van-row>\n              <van-row>\n                <van-col span=\"8\" class=\"otherinfo\">{{item.carriage}}车{{item.seat}}座</van-col>\n                <van-col span=\"8\" offset=\"8\" class=\"otherinfo\">合计<span class=\"price\">￥{{item.price}}</span></van-col>\n               \n                 <van-col span=\"8\" class=\"otherinfo\">{{item.realname}}</van-col>\n                <van-col span=\"8\" offset=\"8\" class=\"otherinfo\">\n                  <van-button class=\"delbutton\" plain  round hairline size=\"small\" type=\"info\" @click.stop=\"delorder(item)\">删除订单</van-button>\n                  </van-col>\n              </van-row>\n        </el-card>\n        \n\n      </div>\n     \n       \n        \n      </van-tab>\n    </van-tabs>\n    </van-pull-refresh>\n  </div>\n</template>\n\n<script>\nimport { Dialog } from 'vant';\nexport default {\n  data() {\n    return {\n      ordernum:[0,0,0,0,0],\n      showflag:false,\n      active:2,\n       count: 0,\n      isLoading: false,\n      tabs:[\"全部\",\"待付款\",\"待出行\",\"已完成\",\"已退款\"],\n      orderlist:[{\n        id:'1',\n        status:2,\n        trainname:'G100',\n        startcity:'杭州',\n        starttime:'16.37',\n        endcity:'绍兴',\n        endtime:'17:35',\n        price:25.3,\n        traindate:\"2020-10-05\",\n        carriage:1,\n        seat:'01A',\n        trainid:'1'\n      }]\n\n    };\n  },\n  created(){\n    if(sessionStorage.getItem('orderactive')){\n      this.active=sessionStorage.getItem('orderactive')\n    }\n   this.queryOrders();\n  },\n  methods: {\n    changeactive(){\n      sessionStorage.setItem('orderactive',this.active);\n    },\n    countordernum(){\n      for (let index = 0; index < this.orderlist.length; index++) {\n        if(this.orderlist[index].status==1)\n          this.ordernum[1]+=1;\n        if(this.orderlist[index].status==2||this.orderlist[index].status==5)\n          this.ordernum[2]+=1;\n        if(this.orderlist[index].status==3)\n          this.ordernum[3]+=1;\n        if(this.orderlist[index].status==4)\n          this.ordernum[4]+=1;\n      }\n    this.ordernum[0]=this.orderlist.length;\n    },\n\n    // 下拉刷新\n    onRefresh() {\n      this.queryOrders();\n      setTimeout(() => {\n        this.$toast('刷新成功');\n        this.isLoading = false;\n      }, 1000);\n    },\n\n\n\n    // 删除订单\n    delorder(val){\n     \n      console.log(val)\n      let that = this;\n      Dialog.confirm({\n      message: '是否删除该订单',\n    }).then(() => {\n       var date = new Date();\n      var nowdate = date.getFullYear()+\"-\"+(date.getMonth()+1)+\"-\"+date.getDate();\n      if(new Date(val.traindate)>=new Date(nowdate)&&val.status!=4){\n          this.$toast.fail(\"该订单尚未出行，不可删除\");\n          return;\n      }     \n      this.$axios({\n        method:'post',\n        url:'/order/delorder',\n        data:this.$qs.stringify({id:val.id})\n      }).then(function(){\n        that.queryOrders();\n       that.$toast(\"删除成功\");\n      }).catch(function (error) {\n          console.log(error);\n      });\n    }).catch(() => {\n        // on cancel\n      });\n    \n    },\n\n    // 订单详情\n    detail(id){\n      sessionStorage.setItem('detailorderid',id);\n     this.$router.push({\n      name: 'detailorder'\n      })\n    },\n\n\n    queryOrders(){\n      let that = this;\n      // 下单id\n      let orderId = JSON.parse(sessionStorage.getItem('user')).id;\n      // 接口查询\n      this.$axios({\n        method:'get',\n        url:'/order/queryorders',\n        params:{\n          orderId:orderId\n        }\n      }).then(function(res){\n        // console.log(res)\n        if(res.data.code==200){\n          that.orderlist = res.data.data\n          that.countordernum();\n          that.showflag=true;\n        }\n      }).catch(function (error) {\n          console.log(error);\n      });\n\n    }\n  },\n\n\n}\n</script>\n\n<style lang=\"less\" scoped>\n.bac{\n  background-color:#f8f8f8;\n  position: relative;\n  //height: 100%;\n  padding-bottom: 40vh; \n}\n.van-pull-refresh{\n  height: 100%;\n  padding: 45px 0;\n}\n.van-nav-bar{\n  background-color: rgba(0, 170, 238, 1);\n    position: fixed;\n  width: 100%;\n  z-index: 99;\n}\n/deep/.van-nav-bar__title{\n  color: white;\n}\n/deep/.van-tab{\n  background-color:#f8f8f8;\n}\n/deep/.el-card__body{\n  padding:8px;\n}\n.van-pull-refresh{\n  height: 100%;\n}\n.box-card{\n  background: #fbfbfb;\n  border-radius: 10px;\n  margin: 15px;\n}\n.trainicon{\n  background-color: red;\n  height: 20px;\n  width:65px;\n  display: inline-block;\n  background: url('../assets/order/arrive1.png') no-repeat;\n}\n.city{\n  font-size: 20px;\n  font-weight: bold;\n}\n.otherinfo{\n  font-size: 14px;\n  margin-top: 5px;\n}\n.price{\n  font-size: 17px;\n}\n.delbutton{\n  margin-top: 10px;\n}\n</style>"]}]}