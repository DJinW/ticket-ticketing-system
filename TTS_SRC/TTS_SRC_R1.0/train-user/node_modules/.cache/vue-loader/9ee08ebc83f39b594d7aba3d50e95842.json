{"remainingRequest":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\src\\views\\ConfirmOrder.vue?vue&type=style&index=0&id=2c101ab0&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\src\\views\\ConfirmOrder.vue","mtime":1617708212000},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\css-loader\\dist\\cjs.js","mtime":1695374999050},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1695374999645},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\postcss-loader\\src\\index.js","mtime":1695374999532},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\less-loader\\dist\\cjs.js","mtime":1695375012442},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1695374980619},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\vue-loader\\lib\\index.js","mtime":1695374999645}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmJhY3sKICBiYWNrZ3JvdW5kLWNvbG9yOiNmOGY4Zjg7CiAgcG9zaXRpb246IGZpeGVkOwogIGhlaWdodDogMTAwJTsgCiAgd2lkdGg6IDEwMCU7Cn0KLnZhbi1uYXYtYmFyewogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMTcwLCAyMzgsIDEpOwogIHBvc2l0aW9uOiBmaXhlZDsKICB3aWR0aDogMTAwJTsKfQovZGVlcC8udmFuLW5hdi1iYXJfX3RpdGxlewogIGNvbG9yOiB3aGl0ZTsKfQovZGVlcC8udmFuLXRhYnsKICBiYWNrZ3JvdW5kLWNvbG9yOiNmOGY4Zjg7Cn0KLmVsLWljb24tYXJyb3ctbGVmdHsKIG1hcmdpbi1sZWZ0OiAwICFpbXBvcnRhbnQ7CiBjb2xvcjogd2hpdGU7CiBmb250LXNpemU6IDIycHg7Cn0KL2RlZXAvLmVsLWNhcmRfX2JvZHl7CiAgcGFkZGluZzo4cHg7Cn0KCi50cmFpbmRhdGV7CiAgcG9zaXRpb246IGZpeGVkOwogIHRvcDo0NXB4OwogIGhlaWdodDogMjJweDsKICBmb250LXNpemU6IDE2cHg7CiAgd2lkdGg6IDEwMCU7CiAgYmFja2dyb3VuZC1jb2xvcjogIHJnYmEoMCwgMTcwLCAyMzgsIDEpOwogIGJvcmRlcjogbm9uZTsKICBjb2xvcjogd2hpdGVzbW9rZTsKICB6LWluZGV4OiAxOwp9CgouY2FyZHsKICBoZWlnaHQ6IDEwMCU7CiAgcGFkZGluZy10b3A6IDcwcHg7Cn0KLmJveC1jYXJkewogIGJhY2tncm91bmQ6ICNmYmZiZmI7CiAgYm9yZGVyLXJhZGl1czogMTBweDsKICBtYXJnaW46IDEwcHg7Cn0KLnRyYWluaWNvbnsKICBiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7CiAgaGVpZ2h0OiAyMHB4OwogIHdpZHRoOjY1cHg7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIGJhY2tncm91bmQ6IHVybCgnLi4vYXNzZXRzL29yZGVyL2Fycml2ZTEucG5nJykgbm8tcmVwZWF0Owp9Ci5jaXR5ewogIGZvbnQtc2l6ZTogMjBweDsKICBmb250LXdlaWdodDogYm9sZDsKfQoub3RoZXJpbmZvewogIGZvbnQtc2l6ZTogMThweDsKICBtYXJnaW4tdG9wOiA1cHg7Cn0KI3RyYWluZGF0ZXsKICBjb2xvcjogI2FhYTsKICBmb250LXNpemU6IDE0cHg7Cn0KLnRpbWVzewogIGNvbG9yOiByZ2JhKDAsIDE3MCwgMjM4LCAxKTsKICBmb250LXNpemU6IDEzcHg7Cn0KLnRpY2tldHsKICBmb250LWZhbWlseTogJ1RyZWJ1Y2hldCBNUycsICdMdWNpZGEgU2FucyBVbmljb2RlJywgJ0x1Y2lkYSBHcmFuZGUnLCAnTHVjaWRhIFNhbnMnLCBBcmlhbCwgc2Fucy1zZXJpZjsKICBmb250LXNpemU6IDEzcHg7Cn0KLnZhbi1maWVsZHsKICBtYXJnaW46IDEwcHg7CiAgYm9yZGVyLXJhZGl1czogN3B4OwogIHdpZHRoOiA5NSU7Cn0KLnZhbi1zdWJtaXQtYmFyX19idXR0b257CiAgd2lkdGg6IDEwMCUgOwp9CgoucHJpY2V7CiAgdGV4dC1kZWNvcmF0aW9uOiBsaW5lLXRocm91Z2g7CiAgZm9udC1zaXplOiAxMHB4OwogIGNvbG9yOiByZ2IoNjMsIDYzLCA2Myk7CiAgbWFyZ2luLWxlZnQ6IDVweDsKfQoucHJpY2V0cnVlewogIGZvbnQtc2l6ZTogMTZweDsKICBjb2xvcjogcmdiKDI1MiwgOTIsIDkyKTsKfQo="},{"version":3,"sources":["ConfirmOrder.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ConfirmOrder.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"bac\">\n    <van-nav-bar\n      title=\"确认订单\">\n     <template #left>\n    <i class=\"el-icon-arrow-left\" @click=\"back\"></i>\n  </template>\n    </van-nav-bar>\n    <div class=\"traindate\">{{this.traindate}}</div>\n    <!-- 订单卡片 -->\n  <div class=\"card\">\n         <div  class=\"text item\">\n\n          <el-card class=\"box-card\">\n              <van-row>\n                <van-col span=\"4\" class=\"otherinfo\">{{order.name}}</van-col>\n                <van-col span=\"7\" class=\"city\">{{order.startcity}}</van-col>\n                <van-col span=\"6\"><i class=\"trainicon\" /></van-col>\n                <van-col span=\"7\" class=\"city\">{{order.endcity}}</van-col>\n              </van-row>\n              <van-row >\n                <van-col span=\"7\" offset=\"4\" class=\"times\">{{order.starttime}}</van-col>\n                <van-col span=\"6\" id=\"traindate\">{{order.duration}}</van-col>\n                <van-col span=\"7\"  class=\"times\">{{order.endtime}}</van-col>\n              </van-row>\n              <van-divider dashed/>\n              <el-radio-group v-model=\"radio\" v-if=\"priceshow\">\n              <el-radio-button label=\"1\">一等 ￥\n                <span class=\"pricetrue\">{{fprice}}</span>\n                <span class=\"price\">{{order.fprice}}</span>\n              </el-radio-button>\n              <el-radio-button label=\"2\">二等 ￥\n                <span class=\"pricetrue\">{{sprice}}</span>\n                <span class=\"price\">{{order.sprice}}</span>\n              </el-radio-button>\n              </el-radio-group>\n               <el-radio-group v-model=\"radio\" v-else>\n              <el-radio-button label=\"1\">一等 ￥{{order.fprice}}</el-radio-button>\n              <el-radio-button label=\"2\">二等 ￥{{order.sprice}}</el-radio-button>\n              </el-radio-group>\n        </el-card>\n      </div> \n        <van-field\n        readonly\n        clickable\n        name=\"picker\"\n        :value=\"value\"\n        label=\"选择乘客\"\n        placeholder=\"点击选择乘车人\"\n        @click=\"selectuser\"\n      />\n     </div>\n\n\n  <van-submit-bar button-text=\"提交订单\" @submit=\"onSubmit\" />\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      priceshow:false,\n      discount:1,\n       radio: '1',\n        value: '',\n      showPicker: false,\n      traindate:'2020/5/30',\n       order:{\n        id:'',\n        state:3,\n        name:'G100',\n        startcity:'杭州',\n        starttime:'16.37',\n        endcity:'绍兴',\n        endtime:'17:35',\n        duration:'23',\n        fnum:'33',\n        snum:'44',\n        fprice:33,\n        sprice:19\n      },\n      userlist:[{\n        id:'',\n        realname:'张三',\n        idcard:'330612154722541',\n        type:0\n      }]\n    };\n  },\n  created(){\n      this.traindate=localStorage.getItem('traindate');\n      this.order=JSON.parse(localStorage.getItem('trainorder'))\n      if(JSON.parse(localStorage.getItem('selectuser'))){\n        var user = JSON.parse(localStorage.getItem('selectuser'))\n         this.value=user.name+\"          \"+user.idcard;\n      }\n      this.getdiscount()\n       \n  },\n  computed: {\n    fprice(){\n      return this.order.fprice*this.discount;\n    },\n    sprice(){\n      return this.order.sprice*this.discount;\n    }\n  },\n  methods: {\n    back(){\n      this.$router.go(-1);\n    },\n    getdiscount(){\n      let that=this;\n      console.log(this.traindate)\n      this.$axios.get('/train/holidaydiscount',{\n        params:{traindate:this.traindate}\n      }).then(res=>{\n        that.discount=res.data.data;\n        if(that.discount==1){\n          that.priceshow=false;\n        }else{\n          that.priceshow=true;\n        }\n      }).catch(error=>{\n        console.log(error);\n      })\n    },\n    selectuser(){\n      this.$router.push(\"selectuser\");\n    },\n    onSubmit(){\n      // 提交延迟\n      this.$toast.loading(\"提交中\");\n      let price;\n      let seattype;\n      if(JSON.parse(localStorage.getItem('selectuser'))==null){\n        this.$toast.fail('请输入乘车人')\n      }\n      let id = JSON.parse(localStorage.getItem('selectuser')).id;\n      \n      let orderId = JSON.parse(sessionStorage.getItem('user')).id;\n      if(this.radio==1){\n          price = this.order.fprice*this.discount;\n          seattype = 1;\n      }else{\n        price = this.order.fprice*this.discount;\n          price = this.order.sprice;\n          seattype = 2;\n      }\n      let that=this;\n      //接口查询\n      this.$axios({\n        method:'post',\n        url:'/order/submitorder',\n        data:{\n            price:price,\n            traindate:this.traindate,\n            userId:id,\n            trainId:this.order.id,\n            seattype:seattype,\n            orderId:orderId\n        }\n      }).then(function(res){\n        if(res.data.code==200){\n          console.log(\"插入成功\");\n          //跳转的页面写在此处             \n          that.$router.push('index');\n        }else if(res.data.code==501){\n           that.$toast(\"该类票已经售罄\");\n        }else if(res.data.code==303){\n           that.$toast(\"该用户审核未通过\");\n        }\n      }).catch(function (error) {\n          console.log(error);\n      });\n    // 延迟跳转\n      const timejump = 1;\n        if(!this.timer){\n            this.count = timejump ;\n            //this.show = false;\n            this.timer = setInterval(()=>{\n            if(this.count > 0 && this.count <= timejump ){\n                this.count--;\n            }else{\n                //this.show = true;\n                clearInterval(this.timer);\n                this.timer = null;\n            }\n          },1000)\n    }\n  },\n}\n}\n</script>\n\n<style lang=\"less\" scoped>\n\n.bac{\n  background-color:#f8f8f8;\n  position: fixed;\n  height: 100%; \n  width: 100%;\n}\n.van-nav-bar{\n  background-color: rgba(0, 170, 238, 1);\n  position: fixed;\n  width: 100%;\n}\n/deep/.van-nav-bar__title{\n  color: white;\n}\n/deep/.van-tab{\n  background-color:#f8f8f8;\n}\n.el-icon-arrow-left{\n margin-left: 0 !important;\n color: white;\n font-size: 22px;\n}\n/deep/.el-card__body{\n  padding:8px;\n}\n\n.traindate{\n  position: fixed;\n  top:45px;\n  height: 22px;\n  font-size: 16px;\n  width: 100%;\n  background-color:  rgba(0, 170, 238, 1);\n  border: none;\n  color: whitesmoke;\n  z-index: 1;\n}\n\n.card{\n  height: 100%;\n  padding-top: 70px;\n}\n.box-card{\n  background: #fbfbfb;\n  border-radius: 10px;\n  margin: 10px;\n}\n.trainicon{\n  background-color: red;\n  height: 20px;\n  width:65px;\n  display: inline-block;\n  background: url('../assets/order/arrive1.png') no-repeat;\n}\n.city{\n  font-size: 20px;\n  font-weight: bold;\n}\n.otherinfo{\n  font-size: 18px;\n  margin-top: 5px;\n}\n#traindate{\n  color: #aaa;\n  font-size: 14px;\n}\n.times{\n  color: rgba(0, 170, 238, 1);\n  font-size: 13px;\n}\n.ticket{\n  font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;\n  font-size: 13px;\n}\n.van-field{\n  margin: 10px;\n  border-radius: 7px;\n  width: 95%;\n}\n.van-submit-bar__button{\n  width: 100% ;\n}\n\n.price{\n  text-decoration: line-through;\n  font-size: 10px;\n  color: rgb(63, 63, 63);\n  margin-left: 5px;\n}\n.pricetrue{\n  font-size: 16px;\n  color: rgb(252, 92, 92);\n}\n</style>"]}]}