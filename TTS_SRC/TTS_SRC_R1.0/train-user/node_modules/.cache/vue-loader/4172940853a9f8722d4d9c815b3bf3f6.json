{"remainingRequest":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\src\\views\\Order.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\src\\views\\Order.vue","mtime":1617708212000},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1695374980619},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\babel-loader\\lib\\index.js","mtime":1695374980610},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1695374980619},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\vue-loader\\lib\\index.js","mtime":1695374999645}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IERpYWxvZyB9IGZyb20gJ3ZhbnQnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG9yZGVybnVtOlswLDAsMCwwLDBdLAogICAgICBzaG93ZmxhZzpmYWxzZSwKICAgICAgYWN0aXZlOjIsCiAgICAgICBjb3VudDogMCwKICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgdGFiczpbIuWFqOmDqCIsIuW+heS7mOasviIsIuW+heWHuuihjCIsIuW3suWujOaIkCIsIuW3sumAgOasviJdLAogICAgICBvcmRlcmxpc3Q6W3sKICAgICAgICBpZDonMScsCiAgICAgICAgc3RhdHVzOjIsCiAgICAgICAgdHJhaW5uYW1lOidHMTAwJywKICAgICAgICBzdGFydGNpdHk6J+adreW3nicsCiAgICAgICAgc3RhcnR0aW1lOicxNi4zNycsCiAgICAgICAgZW5kY2l0eTon57uN5YW0JywKICAgICAgICBlbmR0aW1lOicxNzozNScsCiAgICAgICAgcHJpY2U6MjUuMywKICAgICAgICB0cmFpbmRhdGU6IjIwMjAtMTAtMDUiLAogICAgICAgIGNhcnJpYWdlOjEsCiAgICAgICAgc2VhdDonMDFBJywKICAgICAgICB0cmFpbmlkOicxJwogICAgICB9XQoKICAgIH07CiAgfSwKICBjcmVhdGVkKCl7CiAgICBpZihzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdvcmRlcmFjdGl2ZScpKXsKICAgICAgdGhpcy5hY3RpdmU9c2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnb3JkZXJhY3RpdmUnKQogICAgfQogICB0aGlzLnF1ZXJ5T3JkZXJzKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBjaGFuZ2VhY3RpdmUoKXsKICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnb3JkZXJhY3RpdmUnLHRoaXMuYWN0aXZlKTsKICAgIH0sCiAgICBjb3VudG9yZGVybnVtKCl7CiAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLm9yZGVybGlzdC5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICBpZih0aGlzLm9yZGVybGlzdFtpbmRleF0uc3RhdHVzPT0xKQogICAgICAgICAgdGhpcy5vcmRlcm51bVsxXSs9MTsKICAgICAgICBpZih0aGlzLm9yZGVybGlzdFtpbmRleF0uc3RhdHVzPT0yfHx0aGlzLm9yZGVybGlzdFtpbmRleF0uc3RhdHVzPT01KQogICAgICAgICAgdGhpcy5vcmRlcm51bVsyXSs9MTsKICAgICAgICBpZih0aGlzLm9yZGVybGlzdFtpbmRleF0uc3RhdHVzPT0zKQogICAgICAgICAgdGhpcy5vcmRlcm51bVszXSs9MTsKICAgICAgICBpZih0aGlzLm9yZGVybGlzdFtpbmRleF0uc3RhdHVzPT00KQogICAgICAgICAgdGhpcy5vcmRlcm51bVs0XSs9MTsKICAgICAgfQogICAgdGhpcy5vcmRlcm51bVswXT10aGlzLm9yZGVybGlzdC5sZW5ndGg7CiAgICB9LAoKICAgIC8vIOS4i+aLieWIt+aWsAogICAgb25SZWZyZXNoKCkgewogICAgICB0aGlzLnF1ZXJ5T3JkZXJzKCk7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRoaXMuJHRvYXN0KCfliLfmlrDmiJDlip8nKTsKICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlOwogICAgICB9LCAxMDAwKTsKICAgIH0sCgoKCiAgICAvLyDliKDpmaTorqLljZUKICAgIGRlbG9yZGVyKHZhbCl7CiAgICAgCiAgICAgIGNvbnNvbGUubG9nKHZhbCkKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICBEaWFsb2cuY29uZmlybSh7CiAgICAgIG1lc3NhZ2U6ICfmmK/lkKbliKDpmaTor6XorqLljZUnLAogICAgfSkudGhlbigoKSA9PiB7CiAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgIHZhciBub3dkYXRlID0gZGF0ZS5nZXRGdWxsWWVhcigpKyItIisoZGF0ZS5nZXRNb250aCgpKzEpKyItIitkYXRlLmdldERhdGUoKTsKICAgICAgaWYobmV3IERhdGUodmFsLnRyYWluZGF0ZSk+PW5ldyBEYXRlKG5vd2RhdGUpJiZ2YWwuc3RhdHVzIT00KXsKICAgICAgICAgIHRoaXMuJHRvYXN0LmZhaWwoIuivpeiuouWNleWwmuacquWHuuihjO+8jOS4jeWPr+WIoOmZpCIpOwogICAgICAgICAgcmV0dXJuOwogICAgICB9ICAgICAKICAgICAgdGhpcy4kYXhpb3MoewogICAgICAgIG1ldGhvZDoncG9zdCcsCiAgICAgICAgdXJsOicvb3JkZXIvZGVsb3JkZXInLAogICAgICAgIGRhdGE6dGhpcy4kcXMuc3RyaW5naWZ5KHtpZDp2YWwuaWR9KQogICAgICB9KS50aGVuKGZ1bmN0aW9uKCl7CiAgICAgICAgdGhhdC5xdWVyeU9yZGVycygpOwogICAgICAgdGhhdC4kdG9hc3QoIuWIoOmZpOaIkOWKnyIpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgfSk7CiAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgLy8gb24gY2FuY2VsCiAgICAgIH0pOwogICAgCiAgICB9LAoKICAgIC8vIOiuouWNleivpuaDhQogICAgZGV0YWlsKGlkKXsKICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnZGV0YWlsb3JkZXJpZCcsaWQpOwogICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgbmFtZTogJ2RldGFpbG9yZGVyJwogICAgICB9KQogICAgfSwKCgogICAgcXVlcnlPcmRlcnMoKXsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICAvLyDkuIvljZVpZAogICAgICBsZXQgb3JkZXJJZCA9IEpTT04ucGFyc2Uoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpKS5pZDsKICAgICAgLy8g5o6l5Y+j5p+l6K+iCiAgICAgIHRoaXMuJGF4aW9zKHsKICAgICAgICBtZXRob2Q6J2dldCcsCiAgICAgICAgdXJsOicvb3JkZXIvcXVlcnlvcmRlcnMnLAogICAgICAgIHBhcmFtczp7CiAgICAgICAgICBvcmRlcklkOm9yZGVySWQKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzKXsKICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMpCiAgICAgICAgaWYocmVzLmRhdGEuY29kZT09MjAwKXsKICAgICAgICAgIHRoYXQub3JkZXJsaXN0ID0gcmVzLmRhdGEuZGF0YQogICAgICAgICAgdGhhdC5jb3VudG9yZGVybnVtKCk7CiAgICAgICAgICB0aGF0LnNob3dmbGFnPXRydWU7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgfSk7CgogICAgfQogIH0sCgoKfQo="},{"version":3,"sources":["Order.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA","file":"Order.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"bac\" v-if=\"showflag\">\n     <van-nav-bar title=\"我的订单\"></van-nav-bar>    \n      <!-- 刷新组件 -->\n      <van-pull-refresh v-model=\"isLoading\" @refresh=\"onRefresh\">\n\n      <van-tabs v-model=\"active\" animated @change=\"changeactive\">\n      <van-tab v-for=\"(itemz,indexz) in tabs\" :key=\"indexz\" :title=\"itemz\">\n\n         <div v-if=\"ordernum[indexz]===0\"> <van-empty description=\"来到了没有出行的荒野\" /></div>\n         <div  class=\"text item\" v-for=\"(item,index) in orderlist\" :key=\"index\" @click=\"detail(item.id)\">\n\n          <el-card class=\"box-card\" v-if=\"indexz==0||indexz==item.status||(indexz==2&&item.status==5)\">\n              <van-row><van-col span=\"4\" class=\"otherinfo\">{{item.trainname}}</van-col></van-row>\n              <van-row>\n                <van-col span=\"8\" class=\"city\">{{item.startcity}}</van-col>\n                <van-col span=\"8\"><i class=\"trainicon\" /></van-col>\n                <van-col span=\"8\" class=\"city\">{{item.endcity}}</van-col>\n              </van-row>\n              <van-row class=\"otherinfo\">\n                <van-col span=\"8\">{{item.starttime}}</van-col>\n                <van-col span=\"8\">{{item.traindate}}</van-col>\n                <van-col span=\"8\">{{item.endtime}}</van-col>\n              </van-row>\n              <van-row>\n                <van-col span=\"8\" class=\"otherinfo\">{{item.carriage}}车{{item.seat}}座</van-col>\n                <van-col span=\"8\" offset=\"8\" class=\"otherinfo\">合计<span class=\"price\">￥{{item.price}}</span></van-col>\n               \n                 <van-col span=\"8\" class=\"otherinfo\">{{item.realname}}</van-col>\n                <van-col span=\"8\" offset=\"8\" class=\"otherinfo\">\n                  <van-button class=\"delbutton\" plain  round hairline size=\"small\" type=\"info\" @click.stop=\"delorder(item)\">删除订单</van-button>\n                  </van-col>\n              </van-row>\n        </el-card>\n        \n\n      </div>\n     \n       \n        \n      </van-tab>\n    </van-tabs>\n    </van-pull-refresh>\n  </div>\n</template>\n\n<script>\nimport { Dialog } from 'vant';\nexport default {\n  data() {\n    return {\n      ordernum:[0,0,0,0,0],\n      showflag:false,\n      active:2,\n       count: 0,\n      isLoading: false,\n      tabs:[\"全部\",\"待付款\",\"待出行\",\"已完成\",\"已退款\"],\n      orderlist:[{\n        id:'1',\n        status:2,\n        trainname:'G100',\n        startcity:'杭州',\n        starttime:'16.37',\n        endcity:'绍兴',\n        endtime:'17:35',\n        price:25.3,\n        traindate:\"2020-10-05\",\n        carriage:1,\n        seat:'01A',\n        trainid:'1'\n      }]\n\n    };\n  },\n  created(){\n    if(sessionStorage.getItem('orderactive')){\n      this.active=sessionStorage.getItem('orderactive')\n    }\n   this.queryOrders();\n  },\n  methods: {\n    changeactive(){\n      sessionStorage.setItem('orderactive',this.active);\n    },\n    countordernum(){\n      for (let index = 0; index < this.orderlist.length; index++) {\n        if(this.orderlist[index].status==1)\n          this.ordernum[1]+=1;\n        if(this.orderlist[index].status==2||this.orderlist[index].status==5)\n          this.ordernum[2]+=1;\n        if(this.orderlist[index].status==3)\n          this.ordernum[3]+=1;\n        if(this.orderlist[index].status==4)\n          this.ordernum[4]+=1;\n      }\n    this.ordernum[0]=this.orderlist.length;\n    },\n\n    // 下拉刷新\n    onRefresh() {\n      this.queryOrders();\n      setTimeout(() => {\n        this.$toast('刷新成功');\n        this.isLoading = false;\n      }, 1000);\n    },\n\n\n\n    // 删除订单\n    delorder(val){\n     \n      console.log(val)\n      let that = this;\n      Dialog.confirm({\n      message: '是否删除该订单',\n    }).then(() => {\n       var date = new Date();\n      var nowdate = date.getFullYear()+\"-\"+(date.getMonth()+1)+\"-\"+date.getDate();\n      if(new Date(val.traindate)>=new Date(nowdate)&&val.status!=4){\n          this.$toast.fail(\"该订单尚未出行，不可删除\");\n          return;\n      }     \n      this.$axios({\n        method:'post',\n        url:'/order/delorder',\n        data:this.$qs.stringify({id:val.id})\n      }).then(function(){\n        that.queryOrders();\n       that.$toast(\"删除成功\");\n      }).catch(function (error) {\n          console.log(error);\n      });\n    }).catch(() => {\n        // on cancel\n      });\n    \n    },\n\n    // 订单详情\n    detail(id){\n      sessionStorage.setItem('detailorderid',id);\n     this.$router.push({\n      name: 'detailorder'\n      })\n    },\n\n\n    queryOrders(){\n      let that = this;\n      // 下单id\n      let orderId = JSON.parse(sessionStorage.getItem('user')).id;\n      // 接口查询\n      this.$axios({\n        method:'get',\n        url:'/order/queryorders',\n        params:{\n          orderId:orderId\n        }\n      }).then(function(res){\n        // console.log(res)\n        if(res.data.code==200){\n          that.orderlist = res.data.data\n          that.countordernum();\n          that.showflag=true;\n        }\n      }).catch(function (error) {\n          console.log(error);\n      });\n\n    }\n  },\n\n\n}\n</script>\n\n<style lang=\"less\" scoped>\n.bac{\n  background-color:#f8f8f8;\n  position: relative;\n  //height: 100%;\n  padding-bottom: 40vh; \n}\n.van-pull-refresh{\n  height: 100%;\n  padding: 45px 0;\n}\n.van-nav-bar{\n  background-color: rgba(0, 170, 238, 1);\n    position: fixed;\n  width: 100%;\n  z-index: 99;\n}\n/deep/.van-nav-bar__title{\n  color: white;\n}\n/deep/.van-tab{\n  background-color:#f8f8f8;\n}\n/deep/.el-card__body{\n  padding:8px;\n}\n.van-pull-refresh{\n  height: 100%;\n}\n.box-card{\n  background: #fbfbfb;\n  border-radius: 10px;\n  margin: 15px;\n}\n.trainicon{\n  background-color: red;\n  height: 20px;\n  width:65px;\n  display: inline-block;\n  background: url('../assets/order/arrive1.png') no-repeat;\n}\n.city{\n  font-size: 20px;\n  font-weight: bold;\n}\n.otherinfo{\n  font-size: 14px;\n  margin-top: 5px;\n}\n.price{\n  font-size: 17px;\n}\n.delbutton{\n  margin-top: 10px;\n}\n</style>"]}]}