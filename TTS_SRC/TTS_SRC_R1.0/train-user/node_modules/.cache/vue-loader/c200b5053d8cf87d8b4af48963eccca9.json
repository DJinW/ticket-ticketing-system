{"remainingRequest":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\src\\views\\ConfirmOrder.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\src\\views\\ConfirmOrder.vue","mtime":1617708212000},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1695374980619},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\babel-loader\\lib\\index.js","mtime":1695374980610},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1695374980619},{"path":"C:\\Users\\安姿铜\\Desktop\\TrainTicketSystem-master\\train-user\\node_modules\\vue-loader\\lib\\index.js","mtime":1695374999645}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcHJpY2VzaG93OmZhbHNlLAogICAgICBkaXNjb3VudDoxLAogICAgICAgcmFkaW86ICcxJywKICAgICAgICB2YWx1ZTogJycsCiAgICAgIHNob3dQaWNrZXI6IGZhbHNlLAogICAgICB0cmFpbmRhdGU6JzIwMjAvNS8zMCcsCiAgICAgICBvcmRlcjp7CiAgICAgICAgaWQ6JycsCiAgICAgICAgc3RhdGU6MywKICAgICAgICBuYW1lOidHMTAwJywKICAgICAgICBzdGFydGNpdHk6J+adreW3nicsCiAgICAgICAgc3RhcnR0aW1lOicxNi4zNycsCiAgICAgICAgZW5kY2l0eTon57uN5YW0JywKICAgICAgICBlbmR0aW1lOicxNzozNScsCiAgICAgICAgZHVyYXRpb246JzIzJywKICAgICAgICBmbnVtOiczMycsCiAgICAgICAgc251bTonNDQnLAogICAgICAgIGZwcmljZTozMywKICAgICAgICBzcHJpY2U6MTkKICAgICAgfSwKICAgICAgdXNlcmxpc3Q6W3sKICAgICAgICBpZDonJywKICAgICAgICByZWFsbmFtZTon5byg5LiJJywKICAgICAgICBpZGNhcmQ6JzMzMDYxMjE1NDcyMjU0MScsCiAgICAgICAgdHlwZTowCiAgICAgIH1dCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpewogICAgICB0aGlzLnRyYWluZGF0ZT1sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndHJhaW5kYXRlJyk7CiAgICAgIHRoaXMub3JkZXI9SlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndHJhaW5vcmRlcicpKQogICAgICBpZihKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdzZWxlY3R1c2VyJykpKXsKICAgICAgICB2YXIgdXNlciA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3NlbGVjdHVzZXInKSkKICAgICAgICAgdGhpcy52YWx1ZT11c2VyLm5hbWUrIiAgICAgICAgICAiK3VzZXIuaWRjYXJkOwogICAgICB9CiAgICAgIHRoaXMuZ2V0ZGlzY291bnQoKQogICAgICAgCiAgfSwKICBjb21wdXRlZDogewogICAgZnByaWNlKCl7CiAgICAgIHJldHVybiB0aGlzLm9yZGVyLmZwcmljZSp0aGlzLmRpc2NvdW50OwogICAgfSwKICAgIHNwcmljZSgpewogICAgICByZXR1cm4gdGhpcy5vcmRlci5zcHJpY2UqdGhpcy5kaXNjb3VudDsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGJhY2soKXsKICAgICAgdGhpcy4kcm91dGVyLmdvKC0xKTsKICAgIH0sCiAgICBnZXRkaXNjb3VudCgpewogICAgICBsZXQgdGhhdD10aGlzOwogICAgICBjb25zb2xlLmxvZyh0aGlzLnRyYWluZGF0ZSkKICAgICAgdGhpcy4kYXhpb3MuZ2V0KCcvdHJhaW4vaG9saWRheWRpc2NvdW50Jyx7CiAgICAgICAgcGFyYW1zOnt0cmFpbmRhdGU6dGhpcy50cmFpbmRhdGV9CiAgICAgIH0pLnRoZW4ocmVzPT57CiAgICAgICAgdGhhdC5kaXNjb3VudD1yZXMuZGF0YS5kYXRhOwogICAgICAgIGlmKHRoYXQuZGlzY291bnQ9PTEpewogICAgICAgICAgdGhhdC5wcmljZXNob3c9ZmFsc2U7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICB0aGF0LnByaWNlc2hvdz10cnVlOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyb3I9PnsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pCiAgICB9LAogICAgc2VsZWN0dXNlcigpewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgic2VsZWN0dXNlciIpOwogICAgfSwKICAgIG9uU3VibWl0KCl7CiAgICAgIC8vIOaPkOS6pOW7tui/nwogICAgICB0aGlzLiR0b2FzdC5sb2FkaW5nKCLmj5DkuqTkuK0iKTsKICAgICAgbGV0IHByaWNlOwogICAgICBsZXQgc2VhdHR5cGU7CiAgICAgIGlmKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3NlbGVjdHVzZXInKSk9PW51bGwpewogICAgICAgIHRoaXMuJHRvYXN0LmZhaWwoJ+ivt+i+k+WFpeS5mOi9puS6uicpCiAgICAgIH0KICAgICAgbGV0IGlkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2VsZWN0dXNlcicpKS5pZDsKICAgICAgCiAgICAgIGxldCBvcmRlcklkID0gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd1c2VyJykpLmlkOwogICAgICBpZih0aGlzLnJhZGlvPT0xKXsKICAgICAgICAgIHByaWNlID0gdGhpcy5vcmRlci5mcHJpY2UqdGhpcy5kaXNjb3VudDsKICAgICAgICAgIHNlYXR0eXBlID0gMTsKICAgICAgfWVsc2V7CiAgICAgICAgcHJpY2UgPSB0aGlzLm9yZGVyLmZwcmljZSp0aGlzLmRpc2NvdW50OwogICAgICAgICAgcHJpY2UgPSB0aGlzLm9yZGVyLnNwcmljZTsKICAgICAgICAgIHNlYXR0eXBlID0gMjsKICAgICAgfQogICAgICBsZXQgdGhhdD10aGlzOwogICAgICAvL+aOpeWPo+afpeivogogICAgICB0aGlzLiRheGlvcyh7CiAgICAgICAgbWV0aG9kOidwb3N0JywKICAgICAgICB1cmw6Jy9vcmRlci9zdWJtaXRvcmRlcicsCiAgICAgICAgZGF0YTp7CiAgICAgICAgICAgIHByaWNlOnByaWNlLAogICAgICAgICAgICB0cmFpbmRhdGU6dGhpcy50cmFpbmRhdGUsCiAgICAgICAgICAgIHVzZXJJZDppZCwKICAgICAgICAgICAgdHJhaW5JZDp0aGlzLm9yZGVyLmlkLAogICAgICAgICAgICBzZWF0dHlwZTpzZWF0dHlwZSwKICAgICAgICAgICAgb3JkZXJJZDpvcmRlcklkCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlcyl7CiAgICAgICAgaWYocmVzLmRhdGEuY29kZT09MjAwKXsKICAgICAgICAgIGNvbnNvbGUubG9nKCLmj5LlhaXmiJDlip8iKTsKICAgICAgICAgIC8v6Lez6L2s55qE6aG16Z2i5YaZ5Zyo5q2k5aSEICAgICAgICAgICAgIAogICAgICAgICAgdGhhdC4kcm91dGVyLnB1c2goJ2luZGV4Jyk7CiAgICAgICAgfWVsc2UgaWYocmVzLmRhdGEuY29kZT09NTAxKXsKICAgICAgICAgICB0aGF0LiR0b2FzdCgi6K+l57G756Wo5bey57uP5ZSu572EIik7CiAgICAgICAgfWVsc2UgaWYocmVzLmRhdGEuY29kZT09MzAzKXsKICAgICAgICAgICB0aGF0LiR0b2FzdCgi6K+l55So5oi35a6h5qC45pyq6YCa6L+HIik7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgfSk7CiAgICAvLyDlu7bov5/ot7PovawKICAgICAgY29uc3QgdGltZWp1bXAgPSAxOwogICAgICAgIGlmKCF0aGlzLnRpbWVyKXsKICAgICAgICAgICAgdGhpcy5jb3VudCA9IHRpbWVqdW1wIDsKICAgICAgICAgICAgLy90aGlzLnNob3cgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy50aW1lciA9IHNldEludGVydmFsKCgpPT57CiAgICAgICAgICAgIGlmKHRoaXMuY291bnQgPiAwICYmIHRoaXMuY291bnQgPD0gdGltZWp1bXAgKXsKICAgICAgICAgICAgICAgIHRoaXMuY291bnQtLTsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAvL3RoaXMuc2hvdyA9IHRydWU7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpOwogICAgICAgICAgICAgICAgdGhpcy50aW1lciA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sMTAwMCkKICAgIH0KICB9LAp9Cn0K"},{"version":3,"sources":["ConfirmOrder.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ConfirmOrder.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"bac\">\n    <van-nav-bar\n      title=\"确认订单\">\n     <template #left>\n    <i class=\"el-icon-arrow-left\" @click=\"back\"></i>\n  </template>\n    </van-nav-bar>\n    <div class=\"traindate\">{{this.traindate}}</div>\n    <!-- 订单卡片 -->\n  <div class=\"card\">\n         <div  class=\"text item\">\n\n          <el-card class=\"box-card\">\n              <van-row>\n                <van-col span=\"4\" class=\"otherinfo\">{{order.name}}</van-col>\n                <van-col span=\"7\" class=\"city\">{{order.startcity}}</van-col>\n                <van-col span=\"6\"><i class=\"trainicon\" /></van-col>\n                <van-col span=\"7\" class=\"city\">{{order.endcity}}</van-col>\n              </van-row>\n              <van-row >\n                <van-col span=\"7\" offset=\"4\" class=\"times\">{{order.starttime}}</van-col>\n                <van-col span=\"6\" id=\"traindate\">{{order.duration}}</van-col>\n                <van-col span=\"7\"  class=\"times\">{{order.endtime}}</van-col>\n              </van-row>\n              <van-divider dashed/>\n              <el-radio-group v-model=\"radio\" v-if=\"priceshow\">\n              <el-radio-button label=\"1\">一等 ￥\n                <span class=\"pricetrue\">{{fprice}}</span>\n                <span class=\"price\">{{order.fprice}}</span>\n              </el-radio-button>\n              <el-radio-button label=\"2\">二等 ￥\n                <span class=\"pricetrue\">{{sprice}}</span>\n                <span class=\"price\">{{order.sprice}}</span>\n              </el-radio-button>\n              </el-radio-group>\n               <el-radio-group v-model=\"radio\" v-else>\n              <el-radio-button label=\"1\">一等 ￥{{order.fprice}}</el-radio-button>\n              <el-radio-button label=\"2\">二等 ￥{{order.sprice}}</el-radio-button>\n              </el-radio-group>\n        </el-card>\n      </div> \n        <van-field\n        readonly\n        clickable\n        name=\"picker\"\n        :value=\"value\"\n        label=\"选择乘客\"\n        placeholder=\"点击选择乘车人\"\n        @click=\"selectuser\"\n      />\n     </div>\n\n\n  <van-submit-bar button-text=\"提交订单\" @submit=\"onSubmit\" />\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      priceshow:false,\n      discount:1,\n       radio: '1',\n        value: '',\n      showPicker: false,\n      traindate:'2020/5/30',\n       order:{\n        id:'',\n        state:3,\n        name:'G100',\n        startcity:'杭州',\n        starttime:'16.37',\n        endcity:'绍兴',\n        endtime:'17:35',\n        duration:'23',\n        fnum:'33',\n        snum:'44',\n        fprice:33,\n        sprice:19\n      },\n      userlist:[{\n        id:'',\n        realname:'张三',\n        idcard:'330612154722541',\n        type:0\n      }]\n    };\n  },\n  created(){\n      this.traindate=localStorage.getItem('traindate');\n      this.order=JSON.parse(localStorage.getItem('trainorder'))\n      if(JSON.parse(localStorage.getItem('selectuser'))){\n        var user = JSON.parse(localStorage.getItem('selectuser'))\n         this.value=user.name+\"          \"+user.idcard;\n      }\n      this.getdiscount()\n       \n  },\n  computed: {\n    fprice(){\n      return this.order.fprice*this.discount;\n    },\n    sprice(){\n      return this.order.sprice*this.discount;\n    }\n  },\n  methods: {\n    back(){\n      this.$router.go(-1);\n    },\n    getdiscount(){\n      let that=this;\n      console.log(this.traindate)\n      this.$axios.get('/train/holidaydiscount',{\n        params:{traindate:this.traindate}\n      }).then(res=>{\n        that.discount=res.data.data;\n        if(that.discount==1){\n          that.priceshow=false;\n        }else{\n          that.priceshow=true;\n        }\n      }).catch(error=>{\n        console.log(error);\n      })\n    },\n    selectuser(){\n      this.$router.push(\"selectuser\");\n    },\n    onSubmit(){\n      // 提交延迟\n      this.$toast.loading(\"提交中\");\n      let price;\n      let seattype;\n      if(JSON.parse(localStorage.getItem('selectuser'))==null){\n        this.$toast.fail('请输入乘车人')\n      }\n      let id = JSON.parse(localStorage.getItem('selectuser')).id;\n      \n      let orderId = JSON.parse(sessionStorage.getItem('user')).id;\n      if(this.radio==1){\n          price = this.order.fprice*this.discount;\n          seattype = 1;\n      }else{\n        price = this.order.fprice*this.discount;\n          price = this.order.sprice;\n          seattype = 2;\n      }\n      let that=this;\n      //接口查询\n      this.$axios({\n        method:'post',\n        url:'/order/submitorder',\n        data:{\n            price:price,\n            traindate:this.traindate,\n            userId:id,\n            trainId:this.order.id,\n            seattype:seattype,\n            orderId:orderId\n        }\n      }).then(function(res){\n        if(res.data.code==200){\n          console.log(\"插入成功\");\n          //跳转的页面写在此处             \n          that.$router.push('index');\n        }else if(res.data.code==501){\n           that.$toast(\"该类票已经售罄\");\n        }else if(res.data.code==303){\n           that.$toast(\"该用户审核未通过\");\n        }\n      }).catch(function (error) {\n          console.log(error);\n      });\n    // 延迟跳转\n      const timejump = 1;\n        if(!this.timer){\n            this.count = timejump ;\n            //this.show = false;\n            this.timer = setInterval(()=>{\n            if(this.count > 0 && this.count <= timejump ){\n                this.count--;\n            }else{\n                //this.show = true;\n                clearInterval(this.timer);\n                this.timer = null;\n            }\n          },1000)\n    }\n  },\n}\n}\n</script>\n\n<style lang=\"less\" scoped>\n\n.bac{\n  background-color:#f8f8f8;\n  position: fixed;\n  height: 100%; \n  width: 100%;\n}\n.van-nav-bar{\n  background-color: rgba(0, 170, 238, 1);\n  position: fixed;\n  width: 100%;\n}\n/deep/.van-nav-bar__title{\n  color: white;\n}\n/deep/.van-tab{\n  background-color:#f8f8f8;\n}\n.el-icon-arrow-left{\n margin-left: 0 !important;\n color: white;\n font-size: 22px;\n}\n/deep/.el-card__body{\n  padding:8px;\n}\n\n.traindate{\n  position: fixed;\n  top:45px;\n  height: 22px;\n  font-size: 16px;\n  width: 100%;\n  background-color:  rgba(0, 170, 238, 1);\n  border: none;\n  color: whitesmoke;\n  z-index: 1;\n}\n\n.card{\n  height: 100%;\n  padding-top: 70px;\n}\n.box-card{\n  background: #fbfbfb;\n  border-radius: 10px;\n  margin: 10px;\n}\n.trainicon{\n  background-color: red;\n  height: 20px;\n  width:65px;\n  display: inline-block;\n  background: url('../assets/order/arrive1.png') no-repeat;\n}\n.city{\n  font-size: 20px;\n  font-weight: bold;\n}\n.otherinfo{\n  font-size: 18px;\n  margin-top: 5px;\n}\n#traindate{\n  color: #aaa;\n  font-size: 14px;\n}\n.times{\n  color: rgba(0, 170, 238, 1);\n  font-size: 13px;\n}\n.ticket{\n  font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;\n  font-size: 13px;\n}\n.van-field{\n  margin: 10px;\n  border-radius: 7px;\n  width: 95%;\n}\n.van-submit-bar__button{\n  width: 100% ;\n}\n\n.price{\n  text-decoration: line-through;\n  font-size: 10px;\n  color: rgb(63, 63, 63);\n  margin-left: 5px;\n}\n.pricetrue{\n  font-size: 16px;\n  color: rgb(252, 92, 92);\n}\n</style>"]}]}